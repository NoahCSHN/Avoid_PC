#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Sat Mar 27 11:08:03 2021

@author: bynav
"""

import numpy as np
 
 
####################仅仅是一个示例###################################
 
 
# 双目相机参数
class stereoCamera(object):
    def __init__(self):
        '''
        # 左相机内参
        self.cam_matrix_left = np.array([[906.052143341671, 0, 662.035976643843],
                                         [0., 909.810278518771, 347.812877929693],
                                         [0., 0., 1.]])
        # 右相机内参
        self.cam_matrix_right = np.array([[904.039816599602, 0, 657.374726861859],
                                          [0., 907.144037650865, 371.505562447014],
                                          [0., 0., 1.]])
 
        # 左右相机畸变系数:[k1, k2, p1, p2, k3]
        self.distortion_l = np.array([[0.00069451800687876, 0.0526241964124028, -0.00395258899740901, 0.0029474338458693, -0.135921756945649]])
        self.distortion_r = np.array([[0.00503605508798055, 0.0137569348762201, -0.00339148012519355, 0.00274948038873249, -0.0691817876373664]])
 
        # 旋转矩阵
        self.R = np.array([[0.999999944353214, 0.000141559982260522, 0.00030208333489573],
                           [-0.000141022307976901, 0.999998407337637, -0.00177916691099839],
                           [-0.000302334712615328, 0.00177912421150438, 0.999998371654055]])
 
        # 平移矩阵
        self.T = np.array([[-44.7734208533592], [0.329530613742665], [-0.453620226449132]])
 
        # 焦距 unit:pixel
        self.focal_length = 474.81  # 默认值，一般取立体校正后的重投影矩阵Q中的 Q[2,3]
 
        # 基线距离
        self.baseline = 44.7734208533592  # 单位：mm， 为平移向量的第一个参数（取绝对值）
        
        # pixel size unit: mm
        self.pixel_size = 0.0003
        '''


        '''
        # %% 1280x960
        '''
        print('Camera AR0135 1280x960')
        self.cam_matrix_left = np.array([[900.114185349224, 0, 670.075287577187],
                                        [0., 904.228316085958, 471.765023773669],
                                        [0., 0., 1.]])
        # 右相机内参
        self.cam_matrix_right = np.array([[896.135584664394, 0, 669.702575099279],
                                        [0., 899.168992319405, 492.994037592607],
                                        [0., 0., 1.]])

        # 左右相机畸变系数:[k1, k2, p1, p2, k3]
        self.distortion_l = np.array([[0.00488906840212177, -0.0161131150686868, -0.00258596027519168, 0.00526371337538908, -0.0418911874416988]])
        self.distortion_r = np.array([[-0.013904915007985, 0.0516707668013402, -0.00178988171280563, 0.00648086228771938, -0.0918755222306161]])

        # 旋转矩阵
        self.R = np.array([[0.999997343532194, -0.000356518914434726, -0.00227724017584731],
                        [0.000356153825781219, 0.999999923661093, -0.000160724174948289],
                        [0.00227729730321366, 0.000159912700188857, 0.999997394169065]])

        # 平移矩阵
        self.T = np.array([[-44.9047784155448], [0.403175791582689], [-1.1491319659264]])

        # 焦距 unit:pixel resolution ratio ，1280*960 928.778 640*640 464.389 416*416 344.906
        self.focal_length = 344.906

        # 焦距 unit:pixel 928.778
        self.focal_length_pix = 928.778  # 默认值，一般取立体校正后的重投影矩阵Q中的 Q[2,3]

        # 基线距离
        self.baseline = 44.9047784155448  # 单位：mm， 为平移向量的第一个参数（取绝对值）
        
        # pixel size unit: mm
        self.pixel_size = 0.00375
        
        '''
        # %% 640x640
        '''
        # # 左相机内参
        # print('Camera AR0135 640x480')
        # self.cam_matrix_left = np.array([[464.439312296583, 0, 342.548068699737],
        #                                 [0., 465.457738211478, 233.651433626778],
        #                                 [0., 0., 1.]])
        # # 右相机内参
        # self.cam_matrix_right = np.array([[462.170632901995, 0, 338.079646689704],
        #                                 [0., 462.26842453768, 245.78819336519],
        #                                 [0., 0., 1.]])

        # # 左右相机畸变系数:[k1, k2, p1, p2, k3]
        # self.distortion_l = np.array([[0.0219089239325666, 0.00460092573614185, -0.00646591760327415, 0.0109270275959497, -0.0867620227422152]])
        # self.distortion_r = np.array([[0.0272662496202452, -0.0424029960645065, -0.00484492636909076, 0.0100349479349904, 0.00826485872616951]])

        # # 旋转矩阵
        # self.R = np.array([[0.999975518009243, 0.000152432767973579, -0.00699572343628832],
        #                 [-0.000126983617991523, 0.999993373974003, 0.00363811534319693],
        #                 [0.00699623165043493, -0.00363713793261832, 0.999968911501929]])  
                            
        # # 平移矩阵
        # self.T = np.array([[-45.0518881011289], [0.414329549832418], [-1.42608145944905]])

        # # 焦距 unit:pixel resolution ratio 640*480 403.691
        # self.focal_length = 489.314

        # # 焦距 unit:pixel 349.124
        # self.focal_length_pix = 489.314  # 默认值，一般取立体校正后的重投影矩阵Q中的 Q[2,3]

        # # 基线距离
        # self.baseline = 45.0729106116333  # 单位：mm， 为平移向量的第一个参数（取绝对值）
        
        # # pixel size unit: mm
        # self.pixel_size = 0.00375          

        '''
        # %% 416x416
        '''
        # %% 416x416
        # 左相机内参
        # print('Camera AR0135 416x416')
        # self.cam_matrix_left = np.array([[293.195888689179, 0, 218.325597901095],
        #                                 [0., 294.365147861085, 206.118303552558],
        #                                 [0., 0., 1.]])
        # # 右相机内参
        # self.cam_matrix_right = np.array([[291.955096605521, 0, 217.921287785948],
        #                                 [0., 292.70717271396, 212.965375359883],
        #                                 [0., 0., 1.]])

        # # 左右相机畸变系数:[k1, k2, p1, p2, k3]
        # self.distortion_l = np.array([[0.00684052254457834, -0.00574464194856189, -0.00200329006880111, 0.0055242254656229, -0.0783371961406159]])
        # self.distortion_r = np.array([[-0.00187213990807763, 0.00743523334369973, -0.00147702728105518, 0.00650991239826493, -0.0405684527184752]])

        # # 旋转矩阵
        # # self.R = np.array([[0.9999993466135, 0.000328651484103124, 0.00109487934238393],
        # #                 [-0.000328600737852655, 0.999999944928336, -0.0000465282816077705],
        # #                 [-0.00109489457367591, 0.0000461684730470425, 0.999999399536992]])

        # self.R = np.array([[0.9999993466135, -0.000328600737852655, -0.00109489457367591],
        #                 [0.000328651484103124, 0.999999944928336, 0.0000461684730470425],
        #                 [0.00109487934238393, -0.0000465282816077705, 0.999999399536992]])  
                            
        # # 平移矩阵
        # self.T = np.array([[-44.9785050731846], [0.421185538830781], [-0.943891144635831]])

        # # 焦距 unit:pixel resolution ratio 416*416 349.124
        # self.focal_length = 349.124

        # # 焦距 unit:pixel 349.124
        # self.focal_length_pix = 349.124  # 默认值，一般取立体校正后的重投影矩阵Q中的 Q[2,3]

        # # 基线距离
        # self.baseline = 44.9785050731846  # 单位：mm， 为平移向量的第一个参数（取绝对值）
        
        # # pixel size unit: mm
        # self.pixel_size = 0.00375  